{% extends 'chat/base.html' %}

{% block head %} <!-- cssブロックの開始 -->
<title>チャットルーム</title>
<link rel="stylesheet" href="../../static/css/btn3.css">
<link rel="stylesheet" href="../../static/css/chatroom.css">
{% endblock %} <!-- cssブロックの終了 -->

{% block main %} <!-- mainブロックの開始 -->
<div class="main-container"> <!-- メインコンテナ -->
    <!-- 戻るボタン -->
    <form action="/index">
        <button class="back-button">戻る</button>
    </form>

    <div class="container">

        <!-- チャットルーム名 -->
        <div class="chat-title">
            <h2>{{ room['room_name'] }}</h2>
        </div>

    <!-- ユーザー情報バー -->
    <div class="user-info-bar" id="user-info-bar">
        <img src="{{ user['icon_path'] }}" alt="User Image">
        <h2>{{ user['user_name'] }}</h2>
    </div>

    <!-- ユーザー情報（初期状態は非表示） -->
    <div class="user-info" id="user-info">
        <p>メールアドレス：{{ user['mail'] }}</p>
        <!-- 他のユーザー情報を追加 -->
    </div>

    {% if messages %}
    <!-- チャット欄 -->
    <div class="chat-area">
    {% for message in messages %}
        {% if message['u_id'] == user['u_id'] %}
        <div class="chat-bubble self">
            <p>{{ message['message'] }}</p>
        </div>
        {% else %}
        <div class="chat-bubble other">
            <p>{{ message['message'] }}</p>
        </div>
        {% endif %}
    {% endfor %}
    </div>
    {% else %}
    <p>メッセージはありません</p>
    {% endif %}

    <!-- チャット送信フォーム -->
    <form id="chat-form" action="/add-message" method="POST">
        <input type="text" id="message-input" placeholder="メッセージを入力" name="message">
        <input type="hidden" name="room_id" value="{{ room['room_id'] }}">
        <button type="submit">送信</button>
    </form>

    </div>
</div>
<!-- {% endblock %} --> <!-- bodyブロックの終了 -->

<!-- {% block script %} --> <!-- scriptブロックの開始 -->
    <!-- JSファイルのリンク -->
    <script src="../../static/js/chat.js"></script>
<!-- {% endblock %} --> <!-- scriptブロックの終了 -->